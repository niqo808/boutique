<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nuestras Sucursales - La Paz</title>
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" 
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" 
          crossorigin=""/>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <!-- Estilos personalizados -->
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/sucursales.css">
    
    <style>
        /* Estilos adicionales para Leaflet markers customizados */
        .custom-marker {
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        
        .marker-pin {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #B33A3A, #8B2C2C);
            border-radius: 50% 50% 50% 0;
            transform: rotate(-45deg);
            box-shadow: 
                0 4px 16px rgba(179, 58, 58, 0.6),
                0 0 20px rgba(179, 58, 58, 0.4);
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            animation: bounceInMarker 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        
        @keyframes bounceInMarker {
            0% {
                transform: rotate(-45deg) scale(0);
                opacity: 0;
            }
            50% {
                transform: rotate(-45deg) scale(1.2);
            }
            100% {
                transform: rotate(-45deg) scale(1);
                opacity: 1;
            }
        }
        
        .marker-pin::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(45deg);
            width: 20px;
            height: 20px;
            background: #FFFEF8;
            border-radius: 50%;
            box-shadow: 0 0 8px rgba(255, 255, 255, 0.8);
        }
        
        .marker-pin::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 100%;
            height: 100%;
            border-radius: 50% 50% 50% 0;
            border: 2px solid rgba(255, 255, 255, 0.3);
            animation: pulseRing 2s infinite;
        }
        
        @keyframes pulseRing {
            0% {
                transform: translate(-50%, -50%) scale(1);
                opacity: 1;
            }
            100% {
                transform: translate(-50%, -50%) scale(1.5);
                opacity: 0;
            }
        }
        
        .marker-pin:hover {
            transform: rotate(-45deg) scale(1.2);
            box-shadow: 
                0 8px 24px rgba(179, 58, 58, 0.8),
                0 0 32px rgba(179, 58, 58, 0.6);
        }
        
        .marker-pin.active {
            animation: pulseActive 1.5s infinite;
        }
        
        @keyframes pulseActive {
            0%, 100% {
                transform: rotate(-45deg) scale(1);
            }
            50% {
                transform: rotate(-45deg) scale(1.15);
            }
        }
        
        /* Tooltip personalizado de Leaflet */
        .leaflet-tooltip-own {
            background: rgba(45, 45, 45, 0.95);
            backdrop-filter: blur(10px);
            color: #C29958;
            border: 1px solid rgba(194, 153, 88, 0.3);
            border-radius: 8px;
            padding: 8px 12px;
            font-weight: 600;
            font-size: 0.9rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        .leaflet-tooltip-own::before {
            border-top-color: rgba(45, 45, 45, 0.95);
        }
    </style>
</head>
<body>
    
    <!-- INCLUIR TU NAVIGATION AQU칈 -->
    <nav>
        <div class="nav-container">
            <a href="index.html" class="brand-icon">
                <img src="images/logo.png" alt="La Paz Logo" class="logo-img">
            </a>
            <div class="nav-links">
                <a href="index.html">Inicio</a>
                <a href="productos.html">Productos</a>
                <a href="sucursales.html" class="active">Sucursales</a>
                <a href="sobre-nosotros.html">Sobre Nosotros</a>
                <a href="contacto.html">Contacto</a>
            </div>
            <div class="menu-toggle">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </nav>
    
    <!-- P치gina de Sucursales -->
    <div class="sucursales-page">
        
        <!-- Header Flotante -->
        <div class="floating-header">
            <h1>Nuestras Sucursales</h1>
            <p>Encontr치 la boutique m치s cercana</p>
        </div>
        
        <!-- Mapa con Leaflet -->
        <div id="map-container">
            <div id="map"></div>
        </div>
        
        <!-- Lista de Sucursales (Sidebar) -->
        <div class="sucursales-list">
            <div class="list-header">游늸 Todas las Sucursales</div>
            
            <div class="sucursal-item" data-sucursal="1">
                <h3>Sucursal Centro</h3>
                <p>Microcentro</p>
            </div>
            
            <div class="sucursal-item" data-sucursal="2">
                <h3>Sucursal Palermo</h3>
                <p>Zona Norte</p>
            </div>
            
            <div class="sucursal-item" data-sucursal="3">
                <h3>Sucursal Belgrano</h3>
                <p>Zona Norte</p>
            </div>
            
            <div class="sucursal-item" data-sucursal="4">
                <h3>Sucursal Caballito</h3>
                <p>Zona Oeste</p>
            </div>
            
            <div class="sucursal-item" data-sucursal="5">
                <h3>Sucursal Flores</h3>
                <p>Zona Sur</p>
            </div>
            
            <div class="sucursal-item" data-sucursal="6">
                <h3>Sucursal N칰침ez</h3>
                <p>Zona Norte</p>
            </div>
        </div>
        
        <!-- Card Flotante -->
        <div class="sucursal-card-floating" id="floating-card">
            <!-- Contenido generado din치micamente -->
        </div>
        
    </div>
    
    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" 
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" 
            crossorigin=""></script>
    
    <!-- JavaScript Principal -->
    <script>
        // ============================================
        // DATOS DE LAS 6 SUCURSALES
        // ============================================
        const sucursales = [
            {
                id: 1,
                nombre: "Sucursal Centro",
                zona: "Microcentro",
                lat: -34.6037,
                lng: -58.3816,
                direccion: "Av. Corrientes 1234, CABA",
                telefono: "+54 11 1234-5678",
                email: "centro@lapaz.com.ar",
                horario: "Lun-Vie: 9:00-20:00 | S치b: 9:00-14:00",
                horarioDetalle: {
                    lunes: { inicio: "09:00", fin: "20:00" },
                    martes: { inicio: "09:00", fin: "20:00" },
                    miercoles: { inicio: "09:00", fin: "20:00" },
                    jueves: { inicio: "09:00", fin: "20:00" },
                    viernes: { inicio: "09:00", fin: "20:00" },
                    sabado: { inicio: "09:00", fin: "14:00" },
                    domingo: { inicio: null, fin: null }
                },
                servicios: ["Venta minorista", "Delivery", "Parking"],
                imagenes: [
                    "images/carne.jpg",
                    "images/carne4.jpg",
                    "images/carne7.jpg"
                ]
            },
            {
                id: 2,
                nombre: "Sucursal Palermo",
                zona: "Zona Norte",
                lat: -34.5885,
                lng: -58.4194,
                direccion: "Av. Santa Fe 4567, CABA",
                telefono: "+54 11 2345-6789",
                email: "palermo@lapaz.com.ar",
                horario: "Lun-Vie: 9:00-20:00 | S치b: 9:00-18:00",
                horarioDetalle: {
                    lunes: { inicio: "09:00", fin: "20:00" },
                    martes: { inicio: "09:00", fin: "20:00" },
                    miercoles: { inicio: "09:00", fin: "20:00" },
                    jueves: { inicio: "09:00", fin: "20:00" },
                    viernes: { inicio: "09:00", fin: "20:00" },
                    sabado: { inicio: "09:00", fin: "18:00" },
                    domingo: { inicio: null, fin: null }
                },
                servicios: ["Venta mayorista", "Delivery", "Parking", "Wi-Fi"],
                imagenes: [
                    "images/lomo.jpg",
                    "images/carne.jpg",
                    "images/carne4.jpg"
                ]
            },
            {
                id: 3,
                nombre: "Sucursal Belgrano",
                zona: "Zona Norte",
                lat: -34.5628,
                lng: -58.4571,
                direccion: "Av. Cabildo 2890, CABA",
                telefono: "+54 11 3456-7890",
                email: "belgrano@lapaz.com.ar",
                horario: "Lun-Vie: 9:00-19:30 | S치b: 9:00-14:00",
                horarioDetalle: {
                    lunes: { inicio: "09:00", fin: "19:30" },
                    martes: { inicio: "09:00", fin: "19:30" },
                    miercoles: { inicio: "09:00", fin: "19:30" },
                    jueves: { inicio: "09:00", fin: "19:30" },
                    viernes: { inicio: "09:00", fin: "19:30" },
                    sabado: { inicio: "09:00", fin: "14:00" },
                    domingo: { inicio: null, fin: null }
                },
                servicios: ["Venta minorista", "Parking"],
                imagenes: [
                    "images/bife_ancho.jpg",
                    "images/lomo.jpg",
                    "images/carne7.jpg"
                ]
            },
            {
                id: 4,
                nombre: "Sucursal Caballito",
                zona: "Zona Oeste",
                lat: -34.6186,
                lng: -58.4407,
                direccion: "Av. Rivadavia 5678, CABA",
                telefono: "+54 11 4567-8901",
                email: "caballito@lapaz.com.ar",
                horario: "Lun-Vie: 9:00-20:00 | S치b: 9:00-16:00",
                horarioDetalle: {
                    lunes: { inicio: "09:00", fin: "20:00" },
                    martes: { inicio: "09:00", fin: "20:00" },
                    miercoles: { inicio: "09:00", fin: "20:00" },
                    jueves: { inicio: "09:00", fin: "20:00" },
                    viernes: { inicio: "09:00", fin: "20:00" },
                    sabado: { inicio: "09:00", fin: "16:00" },
                    domingo: { inicio: null, fin: null }
                },
                servicios: ["Venta minorista", "Delivery", "Wi-Fi"],
                imagenes: [
                    "images/carne4.jpg",
                    "images/bife_angosto.jpg",
                    "images/carne.jpg"
                ]
            },
            {
                id: 5,
                nombre: "Sucursal Flores",
                zona: "Zona Sur",
                lat: -34.6296,
                lng: -58.4657,
                direccion: "Av. Directorio 3456, CABA",
                telefono: "+54 11 5678-9012",
                email: "flores@lapaz.com.ar",
                horario: "Lun-Vie: 9:00-19:00 | S치b: 9:00-13:00",
                horarioDetalle: {
                    lunes: { inicio: "09:00", fin: "19:00" },
                    martes: { inicio: "09:00", fin: "19:00" },
                    miercoles: { inicio: "09:00", fin: "19:00" },
                    jueves: { inicio: "09:00", fin: "19:00" },
                    viernes: { inicio: "09:00", fin: "19:00" },
                    sabado: { inicio: "09:00", fin: "13:00" },
                    domingo: { inicio: null, fin: null }
                },
                servicios: ["Venta minorista", "Delivery"],
                imagenes: [
                    "images/carne7.jpg",
                    "images/carne4.jpg",
                    "images/lomo.jpg"
                ]
            },
            {
                id: 6,
                nombre: "Sucursal N칰침ez",
                zona: "Zona Norte",
                lat: -34.5435,
                lng: -58.4520,
                direccion: "Av. Cabildo 4123, CABA",
                telefono: "+54 11 6789-0123",
                email: "nunez@lapaz.com.ar",
                horario: "Lun-Vie: 9:00-20:30 | S치b: 9:00-17:00",
                horarioDetalle: {
                    lunes: { inicio: "09:00", fin: "20:30" },
                    martes: { inicio: "09:00", fin: "20:30" },
                    miercoles: { inicio: "09:00", fin: "20:30" },
                    jueves: { inicio: "09:00", fin: "20:30" },
                    viernes: { inicio: "09:00", fin: "20:30" },
                    sabado: { inicio: "09:00", fin: "17:00" },
                    domingo: { inicio: null, fin: null }
                },
                servicios: ["Venta minorista", "Venta mayorista", "Parking", "Wi-Fi"],
                imagenes: [
                    "images/bife_angosto.jpg",
                    "images/carne.jpg",
                    "images/bife_ancho.jpg"
                ]
            }
        ];
        
        // ============================================
        // VARIABLES GLOBALES
        // ============================================
        let map;
        let markers = [];
        let currentImageIndex = {};
        
        // ============================================
        // INICIALIZAR MAPA CON LEAFLET
        // ============================================
        function initMap() {
            // Centro del mapa en Buenos Aires
            const center = [-34.6037, -58.3816];
            
            // Crear mapa
            map = L.map('map', {
                center: center,
                zoom: 12,
                zoomControl: true,
                attributionControl: true
            });
            
            // A침adir capa de OpenStreetMap
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '춸 OpenStreetMap contributors',
                maxZoom: 19
            }).addTo(map);
            
            // Crear marcadores para cada sucursal
            sucursales.forEach((sucursal, index) => {
                // Crear icono personalizado
                const customIcon = L.divIcon({
                    className: 'custom-marker',
                    html: `<div class="marker-pin" data-sucursal-id="${sucursal.id}"></div>`,
                    iconSize: [50, 50],
                    iconAnchor: [25, 50],
                    popupAnchor: [0, -50]
                });
                
                // Crear marcador
                const marker = L.marker([sucursal.lat, sucursal.lng], {
                    icon: customIcon,
                    sucursalId: sucursal.id
                }).addTo(map);
                
                // Tooltip al hover
                marker.bindTooltip(sucursal.nombre, {
                    permanent: false,
                    direction: 'top',
                    className: 'leaflet-tooltip-own',
                    offset: [0, -50]
                });
                
                // Click en marcador
                marker.on('click', function() {
                    showSucursalCard(sucursal);
                });
                
                // Guardar referencia
                markers.push({ marker, sucursal });
                
                // Peque침o delay en la animaci칩n de cada pin
                setTimeout(() => {
                    const pinElement = document.querySelector(`.marker-pin[data-sucursal-id="${sucursal.id}"]`);
                    if (pinElement) {
                        pinElement.style.animationDelay = `${index * 0.1}s`;
                    }
                }, 100);
            });
        }
        
        // ============================================
        // MOSTRAR CARD DE SUCURSAL
        // ============================================
        function showSucursalCard(sucursal) {
            const card = document.getElementById('floating-card');
            
            // Resetear 칤ndice de imagen
            currentImageIndex[sucursal.id] = 0;
            
            // Generar HTML del card
            card.innerHTML = `
                <div class="card-header">
                    <button class="close-btn" onclick="closeCard()">
                        <i class="fas fa-times"></i>
                    </button>
                    
                    <div class="sucursal-numero-badge">${sucursal.id}</div>
                    
                    <h2>${sucursal.nombre}</h2>
                    <p class="zona">${sucursal.zona}</p>
                </div>
                
                <div class="gallery-swiper">
                    <div class="gallery-track" id="gallery-track-${sucursal.id}">
                        ${sucursal.imagenes.map(img => `
                            <div class="gallery-slide">
                                <img src="${img}" alt="${sucursal.nombre}" onerror="this.src='images/carne.jpg'">
                            </div>
                        `).join('')}
                    </div>
                    
                    <button class="gallery-arrow prev" onclick="prevImage(${sucursal.id})">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <button class="gallery-arrow next" onclick="nextImage(${sucursal.id})">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                    
                    <div class="gallery-controls">
                        ${sucursal.imagenes.map((img, idx) => `
                            <div class="gallery-dot ${idx === 0 ? 'active' : ''}" 
                                 onclick="goToImage(${sucursal.id}, ${idx})"></div>
                        `).join('')}
                    </div>
                </div>
                
                <div class="card-body">
                    <div class="info-item">
                        <div class="info-icon">
                            <i class="fas fa-map-marker-alt"></i>
                        </div>
                        <div class="info-content">
                            <h4>Direcci칩n</h4>
                            <p>${sucursal.direccion}</p>
                        </div>
                    </div>
                    
                    <div class="info-item">
                        <div class="info-icon">
                            <i class="fas fa-phone"></i>
                        </div>
                        <div class="info-content">
                            <h4>Tel칠fono</h4>
                            <p>${sucursal.telefono}</p>
                        </div>
                    </div>
                    
                    <div class="info-item">
                        <div class="info-icon">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="info-content">
                            <h4>Horario</h4>
                            <p>${sucursal.horario}</p>
                            ${getHorarioBadge(sucursal)}
                        </div>
                    </div>
                    
                    <div class="info-item">
                        <div class="info-icon">
                            <i class="fas fa-envelope"></i>
                        </div>
                        <div class="info-content">
                            <h4>Email</h4>
                            <p>${sucursal.email}</p>
                        </div>
                    </div>
                    
                    <div class="servicios-list">
                        ${sucursal.servicios.map(servicio => `
                            <span class="servicio-tag">${servicio}</span>
                        `).join('')}
                    </div>
                </div>
                
                <div class="action-buttons">
                    <a href="https://www.google.com/maps/dir/?api=1&destination=${sucursal.lat},${sucursal.lng}" 
                       target="_blank" class="btn-action btn-direcciones">
                        <span>
                            <i class="fas fa-directions"></i>
                            C칩mo llegar
                        </span>
                    </a>
                    
                    <a href="https://wa.me/${sucursal.telefono.replace(/[^0-9]/g, '')}" 
                       target="_blank" class="btn-action btn-whatsapp">
                        <span>
                            <i class="fab fa-whatsapp"></i>
                            WhatsApp
                        </span>
                    </a>
                </div>
            `;
            
            // Mostrar card con animaci칩n
            setTimeout(() => {
                card.classList.add('show');
            }, 100);
            
            // Centrar mapa en la sucursal con animaci칩n suave
            map.flyTo([sucursal.lat, sucursal.lng], 15, {
                duration: 1.5,
                easeLinearity: 0.25
            });
            
            // Activar pin
            document.querySelectorAll('.marker-pin').forEach(pin => {
                pin.classList.remove('active');
            });
            const activePin = document.querySelector(`.marker-pin[data-sucursal-id="${sucursal.id}"]`);
            if (activePin) {
                activePin.classList.add('active');
            }
            
            // Activar item de lista
            document.querySelectorAll('.sucursal-item').forEach(item => {
                item.classList.remove('active');
            });
            const activeItem = document.querySelector(`.sucursal-item[data-sucursal="${sucursal.id}"]`);
            if (activeItem) {
                activeItem.classList.add('active');
            }
        }
        
        // ============================================
        // CERRAR CARD
        // ============================================
        function closeCard() {
            const card = document.getElementById('floating-card');
            card.classList.remove('show');
            
            // Volver al zoom original
            map.flyTo([-34.6037, -58.3816], 12, {
                duration: 1.5,
                easeLinearity: 0.25
            });
            
            // Desactivar todos los pins
            document.querySelectorAll('.marker-pin').forEach(pin => {
                pin.classList.remove('active');
            });
            
            // Desactivar items de lista
            document.querySelectorAll('.sucursal-item').forEach(item => {
                item.classList.remove('active');
            });
        }
        
        // ============================================
        // GALER칈A SWIPEABLE
        // ============================================
        function nextImage(sucursalId) {
            const sucursal = sucursales.find(s => s.id === sucursalId);
            if (!currentImageIndex[sucursalId]) currentImageIndex[sucursalId] = 0;
            
            currentImageIndex[sucursalId] = (currentImageIndex[sucursalId] + 1) % sucursal.imagenes.length;
            updateGallery(sucursalId);
        }
        
        function prevImage(sucursalId) {
            const sucursal = sucursales.find(s => s.id === sucursalId);
            if (!currentImageIndex[sucursalId]) currentImageIndex[sucursalId] = 0;
            
            currentImageIndex[sucursalId] = 
                (currentImageIndex[sucursalId] - 1 + sucursal.imagenes.length) % sucursal.imagenes.length;
            updateGallery(sucursalId);
        }
        
        function goToImage(sucursalId, index) {
            currentImageIndex[sucursalId] = index;
            updateGallery(sucursalId);
        }
        
        function updateGallery(sucursalId) {
            const track = document.getElementById(`gallery-track-${sucursalId}`);
            const index = currentImageIndex[sucursalId] || 0;
            
            if (track) {
                track.style.transform = `translateX(-${index * 100}%)`;
                
                // Actualizar dots
                const dots = track.parentElement.querySelectorAll('.gallery-dot');
                dots.forEach((dot, idx) => {
                    dot.classList.toggle('active', idx === index);
                });
            }
        }
        
        // ============================================
        // VERIFICAR HORARIO
        // ============================================
        function getHorarioBadge(sucursal) {
            const ahora = new Date();
            const diaSemana = ['domingo', 'lunes', 'martes', 'miercoles', 'jueves', 'viernes', 'sabado'][ahora.getDay()];
            const horaActual = ahora.getHours() * 60 + ahora.getMinutes();
            
            const horario = sucursal.horarioDetalle[diaSemana];
            
            if (!horario.inicio || !horario.fin) {
                return '<span class="horario-badge cerrado"><i class="fas fa-circle"></i> CERRADO</span>';
            }
            
            const [horaInicio, minInicio] = horario.inicio.split(':').map(Number);
            const [horaFin, minFin] = horario.fin.split(':').map(Number);
            
            const minutosInicio = horaInicio * 60 + minInicio;
            const minutosFin = horaFin * 60 + minFin;
            
            if (horaActual >= minutosInicio && horaActual < minutosFin) {
                return '<span class="horario-badge"><i class="fas fa-circle"></i> ABIERTO AHORA</span>';
            } else {
                return '<span class="horario-badge cerrado"><i class="fas fa-circle"></i> CERRADO</span>';
            }
        }
        
        // ============================================
        // INICIALIZACI칍N
        // ============================================
        document.addEventListener('DOMContentLoaded', () => {
            // Inicializar mapa
            initMap();
            
            // Click en items de lista
            document.querySelectorAll('.sucursal-item').forEach(item => {
                item.addEventListener('click', () => {
                    const sucursalId = parseInt(item.dataset.sucursal);
                    const sucursal = sucursales.find(s => s.id === sucursalId);
                    if (sucursal) {
                        showSucursalCard(sucursal);
                    }
                });
            });
            
            // Cerrar card con ESC
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    closeCard();
                }
            });
        });
        
        // ============================================
        // MEN칔 MOBILE
        // ============================================
        const menuToggle = document.querySelector('.menu-toggle');
        const navLinks = document.querySelector('.nav-links');
        
        if (menuToggle) {
            menuToggle.addEventListener('click', () => {
                navLinks.classList.toggle('active');
            });
        }
    </script>
    
</body>
</html>